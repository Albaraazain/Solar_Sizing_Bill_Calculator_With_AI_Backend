{
    "sourceFile": "frontend/src/js/components/ReferenceInputPage/ReferenceInputPage.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1733440968212,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1733441015639,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,23 +1,23 @@\n // src/js/components/ReferenceInputPage/ReferenceInputPage.js\r\n import { Api } from \"/src/api/index.js\";\r\n \r\n export class ReferenceInputPage {\r\n-    constructor() {\r\n-        this.state = {\r\n-            provider: '',\r\n-            referenceNumber: '',\r\n-            whatsapp: '',\r\n-            isLoading: false,\r\n-            error: null\r\n-        };\r\n+  constructor() {\r\n+    this.state = {\r\n+      provider: \"\",\r\n+      referenceNumber: \"\",\r\n+      whatsapp: \"\",\r\n+      isLoading: false,\r\n+      error: null,\r\n+    };\r\n \r\n-        this.injectBaseStyles();\r\n-    }\r\n+    this.injectBaseStyles();\r\n+  }\r\n \r\n-    render() {\r\n-        const app = document.getElementById('app');\r\n-        app.innerHTML = `\r\n+  render() {\r\n+    const app = document.getElementById(\"app\");\r\n+    app.innerHTML = `\r\n             <div class=\"main-content\">\r\n                 <!-- Logo Section -->\r\n                 <div class=\"logo-section\">\r\n                     <img src=\"/src/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n@@ -40,13 +40,13 @@\n                 </div>\r\n             </div>\r\n         `;\r\n \r\n-        this.attachEventListeners();\r\n-    }\r\n+    this.attachEventListeners();\r\n+  }\r\n \r\n-    getFormTemplate() {\r\n-        return `\r\n+  getFormTemplate() {\r\n+    return `\r\n             <form id=\"quote-form\" class=\"space-y-6\">\r\n                 <!-- Provider Field -->\r\n                 <div class=\"form-group\">\r\n                     <label class=\"form-label\" for=\"provider\">\r\n@@ -61,22 +61,32 @@\n                         ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                     >\r\n                 </div>\r\n \r\n-                <!-- Reference Number Field -->\r\n                 <div class=\"form-group\">\r\n-                    <label class=\"form-label\" for=\"referenceNumber\">\r\n-                        Enter your bill reference number\r\n-                    </label>\r\n-                    <input \r\n-                        type=\"text\" \r\n-                        id=\"referenceNumber\"\r\n-                        class=\"form-input\"\r\n-                        placeholder=\"Enter reference number\"\r\n-                        value=\"${this.state.referenceNumber}\"\r\n-                        ${this.state.isLoading ? \"disabled\" : \"\"}\r\n-                    >\r\n-                </div>\r\n+                <label class=\"form-label\" for=\"referenceNumber\">\r\n+                    Enter your bill reference number\r\n+                </label>\r\n+                <input \r\n+                    type=\"text\" \r\n+                    id=\"referenceNumber\"\r\n+                    class=\"form-input ${\r\n+                      this.state.error ? \"border-red-500\" : \"\"\r\n+                    }\"\r\n+                    placeholder=\"Enter 9-digit reference number\"\r\n+                    value=\"${this.state.referenceNumber}\"\r\n+                    ${this.state.isLoading ? \"disabled\" : \"\"}\r\n+                >\r\n+                ${\r\n+                  this.state.error\r\n+                    ? `\r\n+                    <p class=\"mt-1 text-sm text-red-600\">\r\n+                        ${this.state.error}\r\n+                    </p>\r\n+                `\r\n+                    : \"\"\r\n+                }\r\n+            </div>\r\n \r\n                 <!-- WhatsApp Field -->\r\n                 <div class=\"form-group\">\r\n                     <label class=\"form-label\" for=\"whatsapp\">\r\n@@ -97,26 +107,31 @@\n                     type=\"submit\" \r\n                     class=\"submit-button\"\r\n                     ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                 >\r\n-                    ${this.state.isLoading ?\r\n-            `<span>Processing</span>\r\n-                         <div class=\"spinner\"></div>` :\r\n-            'Generate Quote'\r\n-        }\r\n+                    ${\r\n+                      this.state.isLoading\r\n+                        ? `<span>Processing</span>\r\n+                         <div class=\"spinner\"></div>`\r\n+                        : \"Generate Quote\"\r\n+                    }\r\n                 </button>\r\n \r\n-                ${this.state.error ? `\r\n+                ${\r\n+                  this.state.error\r\n+                    ? `\r\n                     <div class=\"error-message\">\r\n                         ${this.state.error}\r\n                     </div>\r\n-                ` : ''}\r\n+                `\r\n+                    : \"\"\r\n+                }\r\n             </form>\r\n         `;\r\n-    }\r\n+  }\r\n \r\n-    getRightContentTemplate() {\r\n-        return `\r\n+  getRightContentTemplate() {\r\n+    return `\r\n             <div class=\"right-content\">\r\n                 <p>\r\n                     Our AI tool quickly provides\r\n                     <br>the ideal system size and\r\n@@ -129,13 +144,13 @@\n             <div class=\"powered-by\">\r\n                 POWERED BY AI\r\n             </div>\r\n         `;\r\n-    }\r\n+  }\r\n \r\n-    injectBaseStyles() {\r\n-        const style = document.createElement('style');\r\n-        style.textContent = `\r\n+  injectBaseStyles() {\r\n+    const style = document.createElement(\"style\");\r\n+    style.textContent = `\r\n             :root {\r\n                 --color-bg: #ffffff;\r\n                 --color-fg: #1f2937;\r\n                 --color-bg-secondary: #f9fafb;\r\n@@ -298,93 +313,101 @@\n                     padding: 1rem;\r\n                 }\r\n             }\r\n         `;\r\n-        document.head.appendChild(style);\r\n+    document.head.appendChild(style);\r\n+  }\r\n+\r\n+  attachEventListeners() {\r\n+    const form = document.getElementById(\"quote-form\");\r\n+    if (form) {\r\n+      form.addEventListener(\"submit\", this.handleSubmit.bind(this));\r\n     }\r\n \r\n-    attachEventListeners() {\r\n-        const form = document.getElementById('quote-form');\r\n-        if (form) {\r\n-            form.addEventListener('submit', this.handleSubmit.bind(this));\r\n-        }\r\n+    const inputs = document.querySelectorAll(\".form-input\");\r\n+    inputs.forEach((input) => {\r\n+      input.addEventListener(\"input\", this.handleInput.bind(this));\r\n+    });\r\n \r\n-        const inputs = document.querySelectorAll('.form-input');\r\n-        inputs.forEach(input => {\r\n-            input.addEventListener('input', this.handleInput.bind(this));\r\n-        });\r\n-\r\n-        const whatsappInput = document.getElementById('whatsapp');\r\n-        if (whatsappInput) {\r\n-            whatsappInput.addEventListener('input', this.formatPhoneNumber.bind(this));\r\n-        }\r\n+    const whatsappInput = document.getElementById(\"whatsapp\");\r\n+    if (whatsappInput) {\r\n+      whatsappInput.addEventListener(\r\n+        \"input\",\r\n+        this.formatPhoneNumber.bind(this)\r\n+      );\r\n     }\r\n+  }\r\n \r\n-    handleInput(event) {\r\n-        const { id, value } = event.target;\r\n-        this.state[id] = value;\r\n+  handleInput(event) {\r\n+    const { id, value } = event.target;\r\n+    this.state[id] = value;\r\n \r\n-        if (this.state.error) {\r\n-            this.setState({ error: null });\r\n-        }\r\n+    if (this.state.error) {\r\n+      this.setState({ error: null });\r\n     }\r\n+  }\r\n \r\n-    formatPhoneNumber(event) {\r\n-        const input = event.target;\r\n-        let value = input.value.replace(/[^\\d+]/g, '');\r\n+  formatPhoneNumber(event) {\r\n+    const input = event.target;\r\n+    let value = input.value.replace(/[^\\d+]/g, \"\");\r\n \r\n-        if (value.startsWith('+92')) {\r\n-            if (value.length > 3) {\r\n-                value = value.slice(0, 3) + ' ' + value.slice(3, 6) + ' ' + value.slice(6, 13);\r\n-            }\r\n-        }\r\n-\r\n-        input.value = value;\r\n-        this.state.whatsapp = value;\r\n+    if (value.startsWith(\"+92\")) {\r\n+      if (value.length > 3) {\r\n+        value =\r\n+          value.slice(0, 3) +\r\n+          \" \" +\r\n+          value.slice(3, 6) +\r\n+          \" \" +\r\n+          value.slice(6, 13);\r\n+      }\r\n     }\r\n \r\n-    handleSubmit = async (event) => {\r\n-        event.preventDefault();\r\n-        if (this.state.isLoading) return;\r\n-    \r\n-        try {\r\n-            this.setState({ isLoading: true, error: null });\r\n-            \r\n-            const response = await Api.bill.validateReferenceNumber(\r\n-                this.state.referenceNumber\r\n-            );\r\n-    \r\n-            if (response.data?.isValid) {\r\n-                sessionStorage.setItem('currentReferenceNumber', this.state.referenceNumber);\r\n-                window.router.push('/bill-review');\r\n-            }\r\n-        } catch (error) {\r\n-            this.setState({ \r\n-                error: error.message || 'Failed to validate reference number. Please try again.',\r\n-                isLoading: false \r\n-            });\r\n-    \r\n-            // Show toast notification if available\r\n-            if (window.toasts) {\r\n-                window.toasts.show(error.message, 'error');\r\n-            }\r\n-        }\r\n-    }\r\n+    input.value = value;\r\n+    this.state.whatsapp = value;\r\n+  }\r\n \r\n-    setState(newState) {\r\n-        this.state = { ...this.state, ...newState };\r\n-        this.updateFormState();\r\n-    }\r\n+  handleSubmit = async (event) => {\r\n+    event.preventDefault();\r\n+    if (this.state.isLoading) return;\r\n \r\n-    updateFormState() {\r\n-        const form = document.getElementById('quote-form');\r\n-        if (!form) return;\r\n+    try {\r\n+      this.setState({ isLoading: true, error: null });\r\n \r\n-        form.innerHTML = this.getFormTemplate();\r\n-        this.attachEventListeners();\r\n-    }\r\n-}\r\n+      const response = await Api.bill.validateReferenceNumber(\r\n+        this.state.referenceNumber\r\n+      );\r\n \r\n+      if (response.data?.isValid) {\r\n+        sessionStorage.setItem(\r\n+          \"currentReferenceNumber\",\r\n+          this.state.referenceNumber\r\n+        );\r\n+        window.router.push(\"/bill-review\");\r\n+      }\r\n+    } catch (error) {\r\n+      this.setState({\r\n+        error:\r\n+          error.message ||\r\n+          \"Failed to validate reference number. Please try again.\",\r\n+        isLoading: false,\r\n+      });\r\n \r\n+      // Show toast notification if available\r\n+      if (window.toasts) {\r\n+        window.toasts.show(error.message, \"error\");\r\n+      }\r\n+    }\r\n+  };\r\n \r\n+  setState(newState) {\r\n+    this.state = { ...this.state, ...newState };\r\n+    this.updateFormState();\r\n+  }\r\n \r\n+  updateFormState() {\r\n+    const form = document.getElementById(\"quote-form\");\r\n+    if (!form) return;\r\n \r\n+    form.innerHTML = this.getFormTemplate();\r\n+    this.attachEventListeners();\r\n+  }\r\n+}\r\n"
                },
                {
                    "date": 1733441857343,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -369,9 +369,9 @@\n     event.preventDefault();\r\n     if (this.state.isLoading) return;\r\n \r\n     try {\r\n-      this.setState({ isLoading: true, error: null });\r\n+        this.setState({ isLoading: true, error: null });\r\n \r\n       const response = await Api.bill.validateReferenceNumber(\r\n         this.state.referenceNumber\r\n       );\r\n"
                }
            ],
            "date": 1733440968212,
            "name": "Commit-0",
            "content": "// src/js/components/ReferenceInputPage/ReferenceInputPage.js\r\nimport { Api } from \"/src/api/index.js\";\r\n\r\nexport class ReferenceInputPage {\r\n    constructor() {\r\n        this.state = {\r\n            provider: '',\r\n            referenceNumber: '',\r\n            whatsapp: '',\r\n            isLoading: false,\r\n            error: null\r\n        };\r\n\r\n        this.injectBaseStyles();\r\n    }\r\n\r\n    render() {\r\n        const app = document.getElementById('app');\r\n        app.innerHTML = `\r\n            <div class=\"main-content\">\r\n                <!-- Logo Section -->\r\n                <div class=\"logo-section\">\r\n                    <img src=\"/src/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n                </div>\r\n\r\n                <!-- Main Layout -->\r\n                <div class=\"layout-grid\">\r\n                    <!-- Form Section -->\r\n                    <div class=\"form-section\">\r\n                        <div class=\"form-container\">\r\n                            <h2 class=\"form-title\">Get your quote</h2>\r\n                            ${this.getFormTemplate()}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Right Content Section -->\r\n                    <div class=\"right-section\">\r\n                        ${this.getRightContentTemplate()}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        this.attachEventListeners();\r\n    }\r\n\r\n    getFormTemplate() {\r\n        return `\r\n            <form id=\"quote-form\" class=\"space-y-6\">\r\n                <!-- Provider Field -->\r\n                <div class=\"form-group\">\r\n                    <label class=\"form-label\" for=\"provider\">\r\n                        Choose your electricity Provider\r\n                    </label>\r\n                    <input \r\n                        type=\"text\" \r\n                        id=\"provider\"\r\n                        class=\"form-input\"\r\n                        placeholder=\"e.g., MEPCO\"\r\n                        value=\"${this.state.provider}\"\r\n                        ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                    >\r\n                </div>\r\n\r\n                <!-- Reference Number Field -->\r\n                <div class=\"form-group\">\r\n                    <label class=\"form-label\" for=\"referenceNumber\">\r\n                        Enter your bill reference number\r\n                    </label>\r\n                    <input \r\n                        type=\"text\" \r\n                        id=\"referenceNumber\"\r\n                        class=\"form-input\"\r\n                        placeholder=\"Enter reference number\"\r\n                        value=\"${this.state.referenceNumber}\"\r\n                        ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                    >\r\n                </div>\r\n\r\n                <!-- WhatsApp Field -->\r\n                <div class=\"form-group\">\r\n                    <label class=\"form-label\" for=\"whatsapp\">\r\n                        Enter your WhatsApp phone Number\r\n                    </label>\r\n                    <input \r\n                        type=\"tel\" \r\n                        id=\"whatsapp\"\r\n                        class=\"form-input\"\r\n                        placeholder=\"+92 XXX XXXXXXX\"\r\n                        value=\"${this.state.whatsapp}\"\r\n                        ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                    >\r\n                </div>\r\n\r\n                <!-- Submit Button -->\r\n                <button \r\n                    type=\"submit\" \r\n                    class=\"submit-button\"\r\n                    ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                >\r\n                    ${this.state.isLoading ?\r\n            `<span>Processing</span>\r\n                         <div class=\"spinner\"></div>` :\r\n            'Generate Quote'\r\n        }\r\n                </button>\r\n\r\n                ${this.state.error ? `\r\n                    <div class=\"error-message\">\r\n                        ${this.state.error}\r\n                    </div>\r\n                ` : ''}\r\n            </form>\r\n        `;\r\n    }\r\n\r\n    getRightContentTemplate() {\r\n        return `\r\n            <div class=\"right-content\">\r\n                <p>\r\n                    Our AI tool quickly provides\r\n                    <br>the ideal system size and\r\n                    <br>savings estimate—no\r\n                    <br>in-person consultation\r\n                    <br>needed. Get the fastest\r\n                    <br>solar quote in Pakistan!\r\n                </p>\r\n            </div>\r\n            <div class=\"powered-by\">\r\n                POWERED BY AI\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    injectBaseStyles() {\r\n        const style = document.createElement('style');\r\n        style.textContent = `\r\n            :root {\r\n                --color-bg: #ffffff;\r\n                --color-fg: #1f2937;\r\n                --color-bg-secondary: #f9fafb;\r\n                --color-primary: #10b981;\r\n                --color-primary-dark: #059669;\r\n                --color-primary-light: rgba(16, 185, 129, 0.1);\r\n            }\r\n\r\n            .main-content {\r\n                min-height: 100vh;\r\n                background-color: var(--color-bg);\r\n                position: relative;\r\n                overflow: hidden;\r\n            }\r\n\r\n            .layout-grid {\r\n                display: grid;\r\n                grid-template-columns: 2fr 1fr;\r\n                min-height: 100vh;\r\n            }\r\n\r\n            .form-section {\r\n                padding: 2rem;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n            }\r\n\r\n            .form-container {\r\n                max-width: 28rem;\r\n                width: 100%;\r\n            }\r\n\r\n            .logo-section {\r\n                position: absolute;\r\n                top: 2rem;\r\n                left: 3rem;\r\n                z-index: 10;\r\n            }\r\n\r\n            .form-title {\r\n                font-size: 1.5rem;\r\n                font-weight: 600;\r\n                color: var(--color-primary);\r\n                margin-bottom: 1.5rem;\r\n            }\r\n\r\n            .form-group {\r\n                margin-bottom: 1.5rem;\r\n            }\r\n\r\n            .form-label {\r\n                display: block;\r\n                font-size: 0.875rem;\r\n                font-weight: 500;\r\n                color: var(--color-fg);\r\n                margin-bottom: 0.5rem;\r\n            }\r\n\r\n            .form-input {\r\n                width: 100%;\r\n                padding: 0.75rem 1rem;\r\n                border: 1px solid #e5e7eb;\r\n                border-radius: 0.375rem;\r\n                font-size: 0.875rem;\r\n                transition: border-color 0.2s;\r\n            }\r\n\r\n            .form-input:focus {\r\n                border-color: var(--color-primary);\r\n                outline: none;\r\n                box-shadow: 0 0 0 3px var(--color-primary-light);\r\n            }\r\n\r\n            .submit-button {\r\n                width: 100%;\r\n                padding: 0.75rem 1.5rem;\r\n                background-color: var(--color-primary);\r\n                color: white;\r\n                border: none;\r\n                border-radius: 0.375rem;\r\n                font-weight: 500;\r\n                cursor: pointer;\r\n                transition: background-color 0.2s;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                gap: 0.5rem;\r\n            }\r\n\r\n            .submit-button:hover:not(:disabled) {\r\n                background-color: var(--color-primary-dark);\r\n            }\r\n\r\n            .submit-button:disabled {\r\n                opacity: 0.7;\r\n                cursor: not-allowed;\r\n            }\r\n\r\n            .right-section {\r\n                background-color: var(--color-primary);\r\n                color: white;\r\n                padding: 2rem;\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: center;\r\n            }\r\n\r\n            .right-content {\r\n                font-size: 1.5rem;\r\n                line-height: 1.4;\r\n            }\r\n\r\n            .powered-by {\r\n                margin-top: 2rem;\r\n                font-size: 0.875rem;\r\n                opacity: 0.8;\r\n            }\r\n\r\n            .error-message {\r\n                margin-top: 1rem;\r\n                padding: 0.75rem;\r\n                background-color: #fee2e2;\r\n                border: 1px solid #ef4444;\r\n                border-radius: 0.375rem;\r\n                color: #dc2626;\r\n                font-size: 0.875rem;\r\n            }\r\n\r\n            .spinner {\r\n                width: 1.25rem;\r\n                height: 1.25rem;\r\n                border: 2px solid rgba(255,255,255,0.3);\r\n                border-radius: 50%;\r\n                border-top-color: white;\r\n                animation: spin 1s linear infinite;\r\n            }\r\n\r\n            @keyframes spin {\r\n                to { transform: rotate(360deg); }\r\n            }\r\n\r\n            @media (max-width: 768px) {\r\n                .layout-grid {\r\n                    grid-template-columns: 1fr;\r\n                }\r\n\r\n                .right-section {\r\n                    display: none;\r\n                }\r\n\r\n                .logo-section {\r\n                    position: relative;\r\n                    top: 0;\r\n                    left: 0;\r\n                    padding: 1rem;\r\n                }\r\n\r\n                .form-section {\r\n                    padding: 1rem;\r\n                }\r\n            }\r\n        `;\r\n        document.head.appendChild(style);\r\n    }\r\n\r\n    attachEventListeners() {\r\n        const form = document.getElementById('quote-form');\r\n        if (form) {\r\n            form.addEventListener('submit', this.handleSubmit.bind(this));\r\n        }\r\n\r\n        const inputs = document.querySelectorAll('.form-input');\r\n        inputs.forEach(input => {\r\n            input.addEventListener('input', this.handleInput.bind(this));\r\n        });\r\n\r\n        const whatsappInput = document.getElementById('whatsapp');\r\n        if (whatsappInput) {\r\n            whatsappInput.addEventListener('input', this.formatPhoneNumber.bind(this));\r\n        }\r\n    }\r\n\r\n    handleInput(event) {\r\n        const { id, value } = event.target;\r\n        this.state[id] = value;\r\n\r\n        if (this.state.error) {\r\n            this.setState({ error: null });\r\n        }\r\n    }\r\n\r\n    formatPhoneNumber(event) {\r\n        let input = event.target;\r\n        let value = input.value.replace(/[^\\d+]/g, '');\r\n\r\n        if (value.startsWith('+92')) {\r\n            if (value.length > 3) {\r\n                value = value.slice(0, 3) + ' ' + value.slice(3, 6) + ' ' + value.slice(6, 13);\r\n            }\r\n        }\r\n\r\n        input.value = value;\r\n        this.state.whatsapp = value;\r\n    }\r\n\r\n    handleSubmit = async (event) => {\r\n        event.preventDefault();\r\n        if (this.state.isLoading) return;\r\n    \r\n        try {\r\n            this.setState({ isLoading: true, error: null });\r\n            \r\n            const response = await Api.bill.validateReferenceNumber(\r\n                this.state.referenceNumber\r\n            );\r\n    \r\n            if (response.data?.isValid) {\r\n                sessionStorage.setItem('currentReferenceNumber', this.state.referenceNumber);\r\n                window.router.push('/bill-review');\r\n            }\r\n        } catch (error) {\r\n            this.setState({ \r\n                error: error.message || 'Failed to validate reference number. Please try again.',\r\n                isLoading: false \r\n            });\r\n    \r\n            // Show toast notification if available\r\n            if (window.toasts) {\r\n                window.toasts.show(error.message, 'error');\r\n            }\r\n        }\r\n    }\r\n\r\n    setState(newState) {\r\n        this.state = { ...this.state, ...newState };\r\n        this.updateFormState();\r\n    }\r\n\r\n    updateFormState() {\r\n        const form = document.getElementById('quote-form');\r\n        if (!form) return;\r\n\r\n        form.innerHTML = this.getFormTemplate();\r\n        this.attachEventListeners();\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"
        }
    ]
}