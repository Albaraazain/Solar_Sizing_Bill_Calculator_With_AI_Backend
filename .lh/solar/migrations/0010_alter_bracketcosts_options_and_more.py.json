{
    "sourceFile": "solar/migrations/0010_alter_bracketcosts_options_and_more.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1733449713376,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1733449769708,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,11 @@\n \r\n from decimal import Decimal\r\n from django.db import migrations, models\r\n \r\n+def clear_bracket_costs(apps, schema_editor):\r\n+    BracketCosts = apps.get_model('solar', 'BracketCosts')\r\n+    BracketCosts.objects.all().delete()\r\n \r\n class Migration(migrations.Migration):\r\n \r\n     dependencies = [\r\n@@ -30,8 +33,10 @@\n         migrations.RemoveField(\r\n             model_name=\"bracketcosts\",\r\n             name=\"cost\",\r\n         ),\r\n+        # Clear existing data\r\n+        migrations.RunPython(clear_bracket_costs),\r\n         # Then add new fields\r\n         migrations.AddField(\r\n             model_name=\"bracketcosts\",\r\n             name=\"min_size\",\r\n"
                }
            ],
            "date": 1733449713376,
            "name": "Commit-0",
            "content": "# Generated by Django 5.1.3 on 2024-12-06 01:47\r\n\r\nfrom decimal import Decimal\r\nfrom django.db import migrations, models\r\n\r\n\r\nclass Migration(migrations.Migration):\r\n\r\n    dependencies = [\r\n        (\"solar\", \"0009_bill_document_alter_potentialcustomers_id_quote\"),\r\n    ]\r\n\r\n    operations = [\r\n        migrations.AlterModelOptions(\r\n            name=\"bracketcosts\",\r\n            options={\r\n                \"verbose_name\": \"Bracket Cost\",\r\n                \"verbose_name_plural\": \"Bracket Costs\",\r\n            },\r\n        ),\r\n        # First remove old fields\r\n        migrations.RemoveField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"SystemRange\",\r\n        ),\r\n        migrations.RemoveField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"Type\",\r\n        ),\r\n        migrations.RemoveField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"cost\",\r\n        ),\r\n        # Then add new fields\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"min_size\",\r\n            field=models.DecimalField(\r\n                decimal_places=2,\r\n                default=Decimal(\"0.00\"),\r\n                help_text=\"Minimum system size in kW\",\r\n                max_digits=5,\r\n            ),\r\n        ),\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"max_size\",\r\n            field=models.DecimalField(\r\n                decimal_places=2,\r\n                default=Decimal(\"999.00\"),\r\n                help_text=\"Maximum system size in kW\",\r\n                max_digits=5,\r\n            ),\r\n        ),\r\n        # Add remaining fields\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"ac_cable\",\r\n            field=models.DecimalField(\r\n                decimal_places=2,\r\n                default=Decimal(\"10000.00\"),\r\n                help_text=\"AC cable cost for this bracket\",\r\n                max_digits=10,\r\n            ),\r\n        ),\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"accessories\",\r\n            field=models.DecimalField(\r\n                decimal_places=2,\r\n                default=Decimal(\"20000.00\"),\r\n                help_text=\"Accessories cost for this bracket\",\r\n                max_digits=10,\r\n            ),\r\n        ),\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"created_at\",\r\n            field=models.DateTimeField(auto_now_add=True, null=True),\r\n        ),\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"dc_cable\",\r\n            field=models.DecimalField(\r\n                decimal_places=2,\r\n                default=Decimal(\"15000.00\"),\r\n                help_text=\"DC cable cost for this bracket\",\r\n                max_digits=10,\r\n            ),\r\n        ),\r\n        migrations.AddField(\r\n            model_name=\"bracketcosts\",\r\n            name=\"updated_at\",\r\n            field=models.DateTimeField(auto_now=True, null=True),\r\n        ),\r\n        # Finally set the unique constraint\r\n        migrations.AlterUniqueTogether(\r\n            name=\"bracketcosts\",\r\n            unique_together={(\"min_size\", \"max_size\")},\r\n        ),\r\n    ]\r\n"
        }
    ]
}